<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open Pages - Firebase</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .redPoint {
            color: red;
            border: 1px solid red;
            border-radius: 5px;
            font-size: 20px;
            padding: 2px 5px;
        }

        .pagination-button {
            margin: 5px;
        }

        #loadingStatus {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background-color: #fff3cd;
            border: 1px solid #ffc107;
        }

        .import-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 2px dashed #6c757d;
        }
    </style>
</head>

<body>
    <div class="container mt-4">
        <div id="loadingStatus" class="alert alert-warning">
            <strong>‚è≥ ƒêang x√°c th·ª±c v·ªõi Firebase...</strong>
        </div>

        <div class="alert alert-info">
            <strong>üî• Firebase Mode:</strong> Kh√¥ng gi·ªõi h·∫°n s·ªë l∆∞·ª£ng records!
        </div>

        <!-- IMPORT DEMO DATA SECTION -->
        <!-- <div class="import-section">
            <h5>üì• Import Demo Data</h5>
            <p class="mb-2">Click button b√™n d∆∞·ªõi ƒë·ªÉ import d·ªØ li·ªáu demo v√†o Firebase Database</p>
            <button id="importDemoButton" class="btn btn-warning" disabled>
                <strong>‚¨ÜÔ∏è Import Demo Data to Firebase</strong>
            </button>
            <span id="importStatus" class="ms-3"></span>
        </div> -->

        <div class="row mb-3">
            <div class="col">
                <input type="text" id="actressName" class="form-control" placeholder="Nh·∫≠p t√™n n·ªØ di·ªÖn vi√™n">
            </div>
            <div class="col">
                <input type="number" id="point" class="form-control" placeholder="ƒêi·ªÉm" min="1" max="10">
            </div>
            <div class="col">
                <button id="saveButton" class="btn btn-primary" disabled>L∆∞u</button>
            </div>
        </div>

        <div class="row mb-3">
            <div class="col">
                <input type="text" id="weburl" class="form-control" placeholder="Nh·∫≠p ƒë∆∞·ªùng d·∫´n b·∫°n mong mu·ªën"
                    value="https://javtiful.com/actress/">
            </div>
        </div>

        <div id="pagination" class="mb-3"></div>

        <div class="row mb-3">
            <div class="col">
                <button id="random" onclick="RandomValue()" class="btn btn-success" disabled>Random</button>
                <button id="refresh" class="btn btn-secondary" disabled>Refresh</button>
                <button id="removeDuplicates" class="btn btn-danger" disabled>Remove Duplicates</button>
                <button id="sort" class="btn btn-info" disabled>Sort by Point ‚Üì</button>
                <button id="sortByName" class="btn btn-warning" disabled>Sort by Name ‚Üë</button>
                <button id="sortByDate" class="btn btn-primary" disabled>Sort by Date ‚Üì</button>
                <button id="sortRandom" class="btn btn-dark" disabled>Sort Random üîÄ</button>
                <input type="text" id="searchByNameAndPoint" class="form-control d-inline-block w-auto"
                    placeholder="Search by name and point" disabled>
            </div>
        </div>

        <table class="table table-striped">
            <thead>
                <tr>
                    <th>STT</th>
                    <th>T√™n</th>
                    <th>ƒêi·ªÉm</th>
                    <th>L∆∞·ª£t xem</th>
                    <th>H√†nh ƒë·ªông</th>
                </tr>
            </thead>
            <tbody id="actressList">
                <!-- Danh s√°ch n·ªØ di·ªÖn vi√™n s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
            </tbody>
        </table>
    </div>

    <!-- Bootstrap JS v√† Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>

    <!-- Firebase SDK v9 (compat mode) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // ========== DEMO DATA ==========
        const demo = [

        ];

        // ========== FIREBASE CONFIG ==========
        const firebaseConfig = {
            apiKey: "AIzaSyCprZ6xU_ZXf4SPqwxcg13BxaHhrzWsylA",
            authDomain: "livelocation-a69e9.firebaseapp.com",
            databaseURL: "https://livelocation-a69e9-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "livelocation-a69e9",
            storageBucket: "livelocation-a69e9.firebasestorage.app",
            messagingSenderId: "447757038633",
            appId: "1:447757038633:web:2680ffd48ec43b7b2d9838",
            measurementId: "G-SKLTNRXDWV"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        let dataValue = [];
        let isAuthenticated = false;

        // Sort state tracking
        let sortState = {
            point: 'desc',  // 'desc' = high to low, 'asc' = low to high
            name: 'asc',    // 'asc' = A to Z, 'desc' = Z to A
            date: 'desc'    // 'desc' = newest first, 'asc' = oldest first
        };

        // ========== AUTHENTICATION ==========
        function enableUI() {
            document.getElementById("saveButton").disabled = false;
            document.getElementById("random").disabled = false;
            document.getElementById("refresh").disabled = false;
            document.getElementById("removeDuplicates").disabled = false;
            document.getElementById("sort").disabled = false;
            document.getElementById("sortByName").disabled = false;
            document.getElementById("sortByDate").disabled = false;
            document.getElementById("sortRandom").disabled = false;
            document.getElementById("searchByNameAndPoint").disabled = false;

            // Only enable import button if it exists
            const importButton = document.getElementById("importDemoButton");
            if (importButton) {
                importButton.disabled = false;
            }

            const statusDiv = document.getElementById("loadingStatus");
            statusDiv.className = "alert alert-success";
            statusDiv.innerHTML = "<strong>‚úÖ ƒê√£ x√°c th·ª±c th√†nh c√¥ng! B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng ·ª©ng d·ª•ng.</strong>";
        }

        function showAuthError(error) {
            const statusDiv = document.getElementById("loadingStatus");
            statusDiv.className = "alert alert-danger";
            statusDiv.innerHTML = `<strong>‚ùå L·ªói x√°c th·ª±c:</strong> ${error.message}`;
        }

        // Sign in anonymously
        auth.signInAnonymously()
            .then(() => {
                console.log("‚úÖ Authenticated successfully");
                isAuthenticated = true;
                enableUI();
                loadAllData();
            })
            .catch((error) => {
                console.error("‚ùå Authentication error:", error);
                showAuthError(error);
            });

        // Monitor auth state
        auth.onAuthStateChanged((user) => {
            if (user) {
                console.log("üë§ User authenticated:", user.uid);
                isAuthenticated = true;
            } else {
                console.log("üë§ User signed out");
                isAuthenticated = false;
            }
        });

        // ========== IMPORT DEMO DATA FUNCTION ==========
        async function importDemoData() {
            if (!isAuthenticated) {
                alert("Ch∆∞a x√°c th·ª±c! Vui l√≤ng ƒë·ª£i...");
                return;
            }

            const confirmImport = confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën import ${demo.length} records v√†o Firebase?\n\nD·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m v√†o database.`);

            if (!confirmImport) {
                return;
            }

            const importButton = document.getElementById("importDemoButton");
            const importStatus = document.getElementById("importStatus");

            importButton.disabled = true;
            importStatus.innerHTML = '<span class="text-warning">‚è≥ ƒêang import...</span>';

            try {
                let successCount = 0;
                let errorCount = 0;

                for (const actress of demo) {
                    try {
                        const newActressRef = database.ref('actresses').push();
                        await newActressRef.set({
                            name: actress.name,
                            point: actress.point,
                            createdAt: new Date().toISOString()
                        });
                        successCount++;
                        console.log(`‚úÖ Imported: ${actress.name}`);
                    } catch (error) {
                        errorCount++;
                        console.error(`‚ùå Failed to import ${actress.name}:`, error);
                    }
                }

                importStatus.innerHTML = `<span class="text-success"><strong>‚úÖ Import ho√†n t·∫•t! Th√†nh c√¥ng: ${successCount}, L·ªói: ${errorCount}</strong></span>`;

                // Reload data to show new records
                setTimeout(() => {
                    loadAllData();
                    importStatus.innerHTML = '';
                }, 2000);

            } catch (error) {
                console.error("‚ùå L·ªói khi import:", error);
                importStatus.innerHTML = `<span class="text-danger">‚ùå L·ªói: ${error.message}</span>`;
            } finally {
                importButton.disabled = false;
            }
        }

        // ========== HELPER FUNCTIONS ==========
        function firebaseToArray(firebaseData) {
            if (!firebaseData) return [];
            return Object.keys(firebaseData).map(key => ({
                firebaseId: key,
                ...firebaseData[key]
            }));
        }

        function openPage(url) {
            window.open(url, "_blank");
        }

        // ========== RANDOM FUNCTION ==========
        function RandomValue() {
            if (dataValue.length === 0) {
                alert("Ch∆∞a c√≥ d·ªØ li·ªáu!");
                return;
            }
            var randomValue = Math.floor(Math.random() * dataValue.length);
            console.log("üöÄ ~ RandomValue ~ randomValue:", randomValue);
            console.log("üöÄ ~ dataValue:", dataValue[randomValue].name);

            var url = document.getElementById("weburl").value;
            var actressName = dataValue[randomValue].name.replace(/\s+/g, '-');
            openPage(url + actressName);
        }

        // ========== CRUD OPERATIONS ==========

        // CREATE - Th√™m m·ªõi actress (s·ª≠ d·ª•ng Firebase SDK)
        async function saveToFirebase(name, point) {
            if (!isAuthenticated) {
                alert("Ch∆∞a x√°c th·ª±c! Vui l√≤ng ƒë·ª£i...");
                return;
            }

            try {
                const newActressRef = database.ref('actresses').push();
                await newActressRef.set({
                    name: name,
                    point: point,
                    count: 0,
                    createdAt: new Date().toISOString()
                });

                console.log("‚úÖ ƒê√£ l∆∞u l√™n Firebase");
                loadAllData();
            } catch (error) {
                console.error("‚ùå L·ªói khi l∆∞u d·ªØ li·ªáu:", error);
                alert("L·ªói khi l∆∞u: " + error.message);
            }
        }

        // READ - L·∫•y t·∫•t c·∫£ data (s·ª≠ d·ª•ng Firebase SDK)
        async function loadAllData() {
            if (!isAuthenticated) {
                console.log("‚è≥ ƒêang ch·ªù x√°c th·ª±c...");
                return;
            }

            try {
                const snapshot = await database.ref('actresses').once('value');
                const data = snapshot.val();

                dataValue = firebaseToArray(data);
                console.log("üìä T·ªïng s·ªë records:", dataValue.length);

                updateActressList(dataValue);
                createPaginationButtons(dataValue.length);
            } catch (error) {
                console.error("‚ùå L·ªói khi l·∫•y d·ªØ li·ªáu:", error);
                alert("L·ªói khi l·∫•y d·ªØ li·ªáu: " + error.message);
            }
        }

        // UPDATE - C·∫≠p nh·∫≠t ƒëi·ªÉm
        async function updateActressPoint(actress) {
            if (!isAuthenticated) {
                alert("Ch∆∞a x√°c th·ª±c! Vui l√≤ng ƒë·ª£i...");
                return;
            }

            const newPoint = prompt(`Ch·ªânh l·∫°i ƒëi·ªÉm Point c·ªßa actress: ${actress.point}`);

            if (newPoint !== null) {
                try {
                    await database.ref(`actresses/${actress.firebaseId}`).update({
                        point: newPoint
                    });

                    console.log('‚úÖ D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t th√†nh c√¥ng.');
                    loadAllData();
                } catch (error) {
                    console.error('‚ùå L·ªói khi c·∫≠p nh·∫≠t:', error);
                    alert('L·ªói khi c·∫≠p nh·∫≠t: ' + error.message);
                }
            }
        }

        // INCREMENT COUNT
        async function incrementSearchCount(actress) {
            if (!isAuthenticated) return;

            const currentCount = actress.count || 0;
            const newCount = currentCount + 1;

            try {
                await database.ref(`actresses/${actress.firebaseId}`).update({
                    count: newCount
                });
                console.log(`‚úÖ ƒê√£ tƒÉng l∆∞·ª£t xem cho ${actress.name} l√™n ${newCount}`);
                loadAllData();
            } catch (error) {
                console.error('‚ùå L·ªói khi tƒÉng l∆∞·ª£t xem:', error);
            }
        }

        // DELETE - X√≥a actress
        async function deleteActress(firebaseId) {
            if (!isAuthenticated) {
                alert("Ch∆∞a x√°c th·ª±c! Vui l√≤ng ƒë·ª£i...");
                return;
            }

            if (!confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a?")) return;

            try {
                await database.ref(`actresses/${firebaseId}`).remove();
                console.log("‚úÖ ƒê√£ x√≥a th√†nh c√¥ng");
                loadAllData();
            } catch (error) {
                console.error("‚ùå L·ªói khi x√≥a:", error);
                alert("L·ªói khi x√≥a: " + error.message);
            }
        }

        // REMOVE DUPLICATES - X√≥a c√°c b·∫£n ghi tr√πng l·∫∑p
        async function removeDuplicates() {
            if (!isAuthenticated) {
                alert("Ch∆∞a x√°c th·ª±c! Vui l√≤ng ƒë·ª£i...");
                return;
            }

            if (dataValue.length === 0) {
                alert("Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ ki·ªÉm tra!");
                return;
            }

            // Normalize name: trim v√† lowercase
            const normalizedMap = new Map();
            const duplicatesToDelete = [];

            dataValue.forEach(actress => {
                const normalizedName = actress.name.trim().toLowerCase();

                if (normalizedMap.has(normalizedName)) {
                    // ƒê√£ c√≥ b·∫£n ghi v·ªõi t√™n n√†y
                    const existing = normalizedMap.get(normalizedName);

                    // So s√°nh point, gi·ªØ l·∫°i c√°i c√≥ point cao h∆°n
                    if (actress.point < existing.point) {
                        // Actress hi·ªán t·∫°i c√≥ point th·∫•p h∆°n -> x√≥a
                        duplicatesToDelete.push({
                            id: actress.firebaseId,
                            name: actress.name,
                            point: actress.point,
                            reason: `Tr√πng v·ªõi "${existing.name}" (point: ${existing.point})`
                        });
                    } else {
                        // Actress hi·ªán t·∫°i c√≥ point cao h∆°n -> x√≥a c√°i c≈©, gi·ªØ c√°i m·ªõi
                        duplicatesToDelete.push({
                            id: existing.firebaseId,
                            name: existing.name,
                            point: existing.point,
                            reason: `Tr√πng v·ªõi "${actress.name}" (point: ${actress.point})`
                        });
                        // Update map v·ªõi actress m·ªõi
                        normalizedMap.set(normalizedName, actress);
                    }
                } else {
                    // Ch∆∞a c√≥ -> th√™m v√†o map
                    normalizedMap.set(normalizedName, actress);
                }
            });

            if (duplicatesToDelete.length === 0) {
                alert("‚úÖ Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu tr√πng l·∫∑p!");
                return;
            }

            // Show confirmation v·ªõi danh s√°ch s·∫Ω x√≥a
            let confirmMessage = `T√¨m th·∫•y ${duplicatesToDelete.length} b·∫£n ghi tr√πng l·∫∑p:\n\n`;
            duplicatesToDelete.forEach((item, index) => {
                confirmMessage += `${index + 1}. "${item.name}" (Point: ${item.point}) - ${item.reason}\n`;
            });
            confirmMessage += `\nB·∫°n c√≥ mu·ªën x√≥a ${duplicatesToDelete.length} b·∫£n ghi n√†y kh√¥ng?`;

            if (!confirm(confirmMessage)) {
                return;
            }

            // Delete duplicates
            let successCount = 0;
            let errorCount = 0;
            const deletedItems = [];

            for (const item of duplicatesToDelete) {
                try {
                    await database.ref(`actresses/${item.id}`).remove();
                    successCount++;
                    deletedItems.push(item.name);
                    console.log(`‚úÖ ƒê√£ x√≥a: ${item.name} (Point: ${item.point})`);
                } catch (error) {
                    errorCount++;
                    console.error(`‚ùå L·ªói khi x√≥a ${item.name}:`, error);
                }
            }

            // Show result
            let resultMessage = `üéâ Ho√†n t·∫•t!\n\n`;
            resultMessage += `‚úÖ ƒê√£ x√≥a: ${successCount} b·∫£n ghi\n`;
            if (errorCount > 0) {
                resultMessage += `‚ùå L·ªói: ${errorCount} b·∫£n ghi\n`;
            }
            resultMessage += `\nDanh s√°ch ƒë√£ x√≥a:\n${deletedItems.join(', ')}`;

            alert(resultMessage);

            // Reload data
            loadAllData();
        }

        // ========== UI FUNCTIONS ==========
        function updateActressList(data) {
            var actressList = document.getElementById("actressList");
            actressList.innerHTML = "";

            if (data.length === 0) {
                actressList.innerHTML = '<tr><td colspan="5" class="text-center">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>';
                return;
            }

            data.forEach((actress, index) => {
                var row = document.createElement('tr');
                var actressIndex = index + 1;

                var viewCount = actress.count || 0;

                row.innerHTML = `
                    <td>${actressIndex}</td>
                    <td>${actress.name}</td>
                    <td><span class="redPoint">${actress.point}</span></td>
                    <td><strong>${viewCount}</strong></td>
                    <td>
                        <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                        <button class="btn btn-sm btn-danger delete-btn">X√≥a</button>
                        <button class="btn btn-sm btn-success search-btn">Search</button>
                    </td>
                `;

                row.querySelector('.edit-btn').addEventListener('click', function () {
                    updateActressPoint(actress);
                });

                row.querySelector('.delete-btn').addEventListener('click', function () {
                    deleteActress(actress.firebaseId);
                });

                row.querySelector('.search-btn').addEventListener('click', function () {
                    incrementSearchCount(actress);
                    var url = document.getElementById("weburl").value;
                    var actressName = actress.name.replace(/\s+/g, '-');
                    openPage(url + actressName);
                });

                actressList.appendChild(row);
            });
        }

        function createPaginationButtons(totalItems) {
            var pagination = document.getElementById("pagination");
            pagination.innerHTML = "";

            if (totalItems === 0) return;

            var totalPages = Math.ceil(totalItems / 10);

            for (let i = 1; i <= totalPages; i++) {
                var button = document.createElement("button");
                button.textContent = `M·ªü trang ${i}`;
                button.classList.add("pagination-button", "btn", "btn-sm", "btn-outline-primary");
                button.addEventListener("click", function () {
                    openPages(i, 10);
                });
                pagination.appendChild(button);
            }
        }

        function openPages(pageNumber, itemsPerPage) {
            var startIndex = (pageNumber - 1) * itemsPerPage;
            var endIndex = startIndex + itemsPerPage;

            var url = document.getElementById("weburl").value;
            var pageData = dataValue.slice(startIndex, endIndex);

            pageData.forEach(actress => {
                var actressName = actress.name.replace(/\s+/g, '-');
                openPage(url + actressName);
            });
        }

        // ========== SORT FUNCTIONS WITH TOGGLE ==========
        function sortActressesByPoint() {
            const button = document.getElementById("sort");

            // Toggle state
            sortState.point = sortState.point === 'desc' ? 'asc' : 'desc';

            const sortedData = [...dataValue].sort((a, b) => {
                if (sortState.point === 'desc') {
                    return b.point - a.point; // High to low
                } else {
                    return a.point - b.point; // Low to high
                }
            });

            // Update button text
            button.textContent = sortState.point === 'desc' ? 'Sort by Point ‚Üì' : 'Sort by Point ‚Üë';

            updateActressList(sortedData);
        }

        function sortActressesByName() {
            const button = document.getElementById("sortByName");

            // Toggle state
            sortState.name = sortState.name === 'asc' ? 'desc' : 'asc';

            const sortedData = [...dataValue].sort((a, b) => {
                if (sortState.name === 'asc') {
                    return a.name.localeCompare(b.name); // A to Z
                } else {
                    return b.name.localeCompare(a.name); // Z to A
                }
            });

            // Update button text
            button.textContent = sortState.name === 'asc' ? 'Sort by Name ‚Üë' : 'Sort by Name ‚Üì';

            updateActressList(sortedData);
        }

        function sortActressesByDate() {
            const button = document.getElementById("sortByDate");

            // Toggle state
            sortState.date = sortState.date === 'desc' ? 'asc' : 'desc';

            const sortedData = [...dataValue].sort((a, b) => {
                const dateA = new Date(a.createdAt || 0);
                const dateB = new Date(b.createdAt || 0);

                if (sortState.date === 'desc') {
                    return dateB - dateA; // Newest first
                } else {
                    return dateA - dateB; // Oldest first
                }
            });

            // Update button text
            button.textContent = sortState.date === 'desc' ? 'Sort by Date ‚Üì' : 'Sort by Date ‚Üë';

            updateActressList(sortedData);
        }

        function sortActressesRandomly() {
            // Fisher-Yates shuffle
            for (let i = dataValue.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [dataValue[i], dataValue[j]] = [dataValue[j], dataValue[i]];
            }
            updateActressList(dataValue);
        }

        // ========== SEARCH FUNCTION ==========
        function setupSearch() {
            const fieldSearch = ['name', 'point'];

            document.getElementById("searchByNameAndPoint").addEventListener("input", function () {
                var searchValue = this.value.toLowerCase();
                var filteredData = dataValue.filter(actress => {
                    return fieldSearch.some(field => {
                        const fieldValue = actress[field].toString().toLowerCase();
                        return fieldValue.includes(searchValue);
                    });
                });

                updateActressList(filteredData);
                createPaginationButtons(filteredData.length);
            });
        }

        // ========== EVENT LISTENERS ==========
        document.getElementById("saveButton").addEventListener("click", function () {
            var actressName = document.getElementById("actressName").value.trim();
            var actressPoint = document.getElementById("point").value.trim();

            if (!actressName || !actressPoint) {
                alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
                return;
            }

            saveToFirebase(actressName, actressPoint);

            // Clear inputs
            document.getElementById("actressName").value = "";
            document.getElementById("point").value = "";
        });

        document.getElementById("refresh").addEventListener("click", function () {
            loadAllData();
        });

        document.getElementById("removeDuplicates").addEventListener("click", function () {
            removeDuplicates();
        });

        document.getElementById("sort").addEventListener("click", function () {
            sortActressesByPoint();
        });

        document.getElementById("sortByName").addEventListener("click", function () {
            sortActressesByName();
        });

        document.getElementById("sortByDate").addEventListener("click", function () {
            sortActressesByDate();
        });

        document.getElementById("sortRandom").addEventListener("click", function () {
            sortActressesRandomly();
        });

        // IMPORT DEMO DATA BUTTON (only if exists)
        const importButton = document.getElementById("importDemoButton");
        if (importButton) {
            importButton.addEventListener("click", function () {
                importDemoData();
            });
        }

        // ========== INIT ==========
        document.addEventListener("DOMContentLoaded", function () {
            setupSearch();
            // loadAllData() will be called after authentication succeeds
        });
    </script>
</body>

</html>