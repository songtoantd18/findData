<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open Pages</title>
</head>

<body>
    <input type="text" id="actressName" placeholder="Nhập tên nữ diễn viên">
    <button id="saveButton">Lưu</button>
    <input type="text" id="weburl" placeholder="Nhập đường dẫn bạn mong muốn" value="https://javtiful.com/actress/">
    <button id="openPagesButton">Mở trang tổng</button>
    <button id="openPagesButton1">Mở trang1</button>

    <button id="openPagesButton2">Mở trang2</button>

    <button id="openPagesButton3">Mở trang3</button>




    <div id="actressList"></div> <!-- Thêm một phần tử để chứa danh sách nữ diễn viên -->

    <script>
        // Lắng nghe sự kiện click trên nút "Lưu"
        document.getElementById("saveButton").addEventListener("click", function () {
            var actressName = document.getElementById("actressName").value;
            saveToApi(actressName);
        });

        // Hàm để lưu dữ liệu lên API
        function saveToApi(name) {
            fetch("https://62fbae6be4bcaf53518af2ed.mockapi.io/api/actress", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    name: name
                })
            })
                .then(response => response.json())
                .then(data => {
                    console.log("Dữ liệu đã được lưu lên API:", data);
                    location.reload(); // Reload lại trang sau khi lưu dữ liệu
                })
                .catch(error => console.error("Lỗi khi lưu dữ liệu:", error));
        }


        function deleteActress(id) {
            fetch(`https://62fbae6be4bcaf53518af2ed.mockapi.io/api/actress/${id}`, {
                method: 'DELETE',
            })
                .then(response => response.json())
                .then(data => console.log("Đã xóa:", data))
                .catch(error => console.error("Lỗi khi xóa:", error));
        }

        // Lắng nghe sự kiện khi tài liệu đã được tải
        document.addEventListener("DOMContentLoaded", function () {
            // Lấy dữ liệu từ API và hiển thị tên nữ diễn viên
            fetch("https://62fbae6be4bcaf53518af2ed.mockapi.io/api/actress")
                .then(response => response.json())
                .then(data => {
                    var actressList = document.getElementById("actressList");
                    data.forEach((actress, index) => { // Thêm index vào forEach
                        var listItem = document.createElement('div');
                        var actressIndex = index + 1; // Chỉ số bắt đầu từ 1
                        listItem.textContent = actressIndex + ". " + actress.name; // Hiển thị chỉ số và tên nữ diễn viên
                        var deleteButton = document.createElement('button');
                        var searchValue = document.createElement('button');
                        searchValue.textContent = "search";

                        deleteButton.textContent = "Xóa";
                        deleteButton.addEventListener('click', function () {
                            deleteActress(actress.id);
                            listItem.remove(); // Xóa phần tử div hiện tại khi nhấn nút xóa
                        });
                        searchValue.addEventListener('click', function () {
                            var url = document.getElementById("weburl").value;

                            console.log('1111111111111')
                            console.log('actress.name:', actress.name);
                            var actressName = actress.name.replace(/\s+/g, '-');
                            console.log("🚀 ~ url:", url)
                            openPage(url + actressName)
                        })
                        listItem.appendChild(deleteButton);
                        listItem.appendChild(searchValue);
                        actressList.appendChild(listItem);
                    });
                    console.log('Math.ceil(data.length / 3):', Math.ceil(data.length / 3));
                    console.log('Math.ceil(data.length / 1.5):', Math.ceil(data.length / 1.5));
                    document.getElementById("openPagesButton1").addEventListener("click", function () {
                        openPages(1, Math.ceil(data.length / 3)); // Mở trang từ 1 đến 17
                    });

                    // Lắng nghe sự kiện click trên nút "Mở trang 2"
                    document.getElementById("openPagesButton2").addEventListener("click", function () {
                        openPages(Math.ceil(data.length / 3) + 1, Math.ceil(data.length / 1.5)); // Mở trang từ 18 đến 34
                    });

                    // Lắng nghe sự kiện click trên nút "Mở trang 3"
                    document.getElementById("openPagesButton3").addEventListener("click", function () {
                        openPages(Math.ceil(data.length / 1.5) + 1, data.length); // Mở trang từ 35 đến 51
                    });
                    document.getElementById("openPagesButton").addEventListener("click", function () {
                        openPages(1, data.length); // Mở trang từ 35 đến 51
                    });
                    function openPages(startIndex, endIndex) {
                        console.log(`dữ liệu từ ${startIndex} đến ${endIndex}   `)
                        console.log("🚀 ~ openPages ~ startIndex:", startIndex)
                        console.log("🚀 ~ openPages ~ endIndex:", endIndex)

                        var url = document.getElementById("weburl").value;
                        fetch("https://62fbae6be4bcaf53518af2ed.mockapi.io/api/actress")
                            .then(response => response.json())
                            .then(data => {
                                data.slice(startIndex - 1, endIndex).forEach(actress => {
                                    var actressName = actress.name.replace(/\s+/g, '-');
                                    console.log("🚀 ~ data.slice ~ actressName:", actressName)
                                    openPage(url + actressName);
                                });
                            })
                            .catch(error => console.error("Lỗi khi lấy dữ liệu từ API:", error));
                    }

                    // Hàm để mở một trang web mới
                    function openPage(url) {
                        window.open(url, "_blank"); // Mở trang web trong cửa sổ mới
                    }

                })
                .catch(error => console.error("Lỗi khi lấy dữ liệu từ API:", error));
        }
        );
    </script>

</body>

</html>